<app-header></app-header>

<ng-container *ngIf="perfil$ | async as perfil; else loginCTA">
  <div class="container-fluid bg-light min-vh-100 d-flex flex-column align-items-center justify-content-center py-5">

    <!-- Logo e título -->
    <div class="text-center mb-5 mt-5">
      <img class="mt-5" src="../../../assets/img/logo2-crenorte.png" alt="Logo Crenorte" />
      <h2 class="text-success fw-bold mt-2">Bem-vindo ao Sistema CRENORTE</h2>
      <div class="badge crn-badge-live mt-2">Perfil: {{ perfil.papel | titlecase }}</div>
    </div>

    <!-- Módulos (cards) -->
    <div class="row w-100 justify-content-center g-3 g-md-4 px-3">

      <!-- ===================== VISÃO ASSESSOR ===================== -->
      <ng-container>
        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/pre-cadastro/novo" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-person-plus"></i></div>
            <div class="mt-2 fw-bold text-dark">Novo Pré-cadastro</div>
          </a>
        </div>

        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/pre-cadastro/minha-lista" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-list-check"></i></div>
            <div class="mt-2 fw-bold text-dark">Minha Lista</div>
          </a>
        </div>

        <!-- Assessor também pode fazer cadastro e ver a listagem -->
        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/cadastro/novo" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-pencil-square"></i></div>
            <div class="mt-2 fw-bold text-dark">Novo Cadastro</div>
          </a>
        </div>

              <!-- Criar Grupo (a partir de cadastro aprovado) -->
        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/grupos/novo" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-people"></i></div>
            <div class="mt-2 fw-bold text-dark">Criar Grupo Solidário</div>
          </a>
        </div>

      </ng-container>

      <!-- ===================== VISÃO ANALISTA / SUPERVISOR / ADMIN ===================== -->
      <ng-container *ngIf="hasAny(perfil.papel, ['analista','supervisor'])">

        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/pre-cadastro/relatorio" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-graph-up"></i></div>
            <div class="mt-2 fw-bold text-dark">Relatório Pré-cadastro</div>
          </a>
        </div>

        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/aprovacoes" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-check2-square"></i></div>
            <div class="mt-2 fw-bold text-dark">Aprovações de Cadastros</div>
          </a>
        </div>

        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/cadastro/novo" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-pencil-square"></i></div>
            <div class="mt-2 fw-bold text-dark">Novo Cadastro</div>
          </a>
        </div>

        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/listagem" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-card-list"></i></div>
            <div class="mt-2 fw-bold text-dark">Listagem de Cadastros</div>
          </a>
        </div>

        <!-- Criar Grupo (a partir de cadastro aprovado) -->
        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/grupos/novo" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-people"></i></div>
            <div class="mt-2 fw-bold text-dark">Criar Grupo Solidário</div>
          </a>
        </div>

      </ng-container>

      <!-- ===================== VISÃO QA / ADMIN (Relatório de Grupos) ===================== -->
      <ng-container *ngIf="hasAny(perfil.papel, ['qa','admin'])">
        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/grupos/relatorio" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-clipboard-data"></i></div>
            <div class="mt-2 fw-bold text-dark">Relatório de Grupos</div>
          </a>
        </div>
      </ng-container>


      <!-- ===================== VISÃO RH ===================== -->
      <ng-container *ngIf="hasAny(perfil.papel, ['admin','rh'])">
        <div class="col-10 col-sm-6 col-md-3">
          <a routerLink="/colaboradores" class="card text-center shadow-sm p-3 text-decoration-none h-100">
            <div class="fs-1 text-success"><i class="bi bi-people-fill"></i></div>
            <div class="mt-2 fw-bold text-dark">Colaboradores</div>
          </a>
        </div>
      </ng-container>



    </div>
  </div>
</ng-container>

<!-- CTA para login quando não autenticado -->
<ng-template #loginCTA>
  <div class="container-fluid bg-light min-vh-100 d-flex flex-column align-items-center justify-content-center">
    <div class="text-center">
      <img src="../../../assets/img/logo2-crenorte.png" alt="Logo Crenorte" />
      <h2 class="text-success fw-bold mt-3">Bem-vindo ao Sistema CRENORTE</h2>
      <p class="mt-2">Faça login para acessar o dashboard.</p>
      <a class="btn btn-success" routerLink="/login">Entrar</a>
    </div>
  </div>
</ng-template>
