<div class="container py-4">
  <h3 class="mb-4 fw-bold text-success">üìã Todos os Cadastros</h3>

  <!-- A√á√ïES -->
  <div class="btn-group flex-wrap mb-4 gap-2">
    <button class="btn btn-warning mb-3" (click)="corrigirCaracteres()">
  <i class="fas fa-wrench me-2"></i> Corrigir caracteres estranhos
</button>

    <button class="btn btn-success fw-bold" (click)="exportarExcel()">
      <i class="fas fa-file-excel me-2"></i> Exportar Excel
    </button>

    <button class="btn btn-info text-white fw-bold" (click)="exportarContatos()">
      <i class="fas fa-address-book me-2"></i> Exportar Contatos
    </button>

    <button class="btn btn-success fw-bold" (click)="linksWhatsapp = gerarMensagensWhatsapp()">
      <i class="fab fa-whatsapp me-2"></i> Gerar WhatsApp
    </button>

    <button class="btn btn-secondary fw-bold" (click)="fileInput.click()">
      <i class="fas fa-upload me-2"></i> Importar Planilha
    </button>
    <input #fileInput type="file" hidden (change)="importarDoExcel($event)" accept=".xlsx, .xls, .csv" />
  </div>

  <!-- FILTROS -->
  <div class="card mb-4 border-0 shadow-sm">
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-3">
          <input type="text" class="form-control" placeholder="üîç Filtrar por nome" [(ngModel)]="filtro.nome" (input)="atualizarListagem()" />
        </div>
        <div class="col-md-3">
          <input type="text" class="form-control" placeholder="üèôÔ∏è Filtrar por cidade" [(ngModel)]="filtro.cidade" (input)="atualizarListagem()" />
        </div>
        <div class="col-md-3">
          <select class="form-select" [(ngModel)]="filtro.empreende" (change)="atualizarListagem()">
            <option value="">ü§î Empreende?</option>
            <option value="Sim">Sim</option>
            <option value="N√£o">N√£o</option>
          </select>
        </div>
        <div class="col-md-3">
          <select class="form-select" [(ngModel)]="filtro.crenorte" (change)="atualizarListagem()">
            <option value="">üè¶ Cliente Crenorte?</option>
            <option value="Sim">Sim</option>
            <option value="N√£o">N√£o</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- TABELA -->
  <div class="table-responsive shadow-sm rounded-4 border">
    <table class="table table-hover align-middle table-bordered mb-0">
      <thead class="table-success sticky-top" style="z-index: 1;">
        <tr>
          <th (click)="ordenarPor('nomeCompleto')" class="cursor-pointer">Nome</th>
          <th (click)="ordenarPor('cpf')" class="cursor-pointer">CPF</th>
          <th (click)="ordenarPor('cidade')" class="cursor-pointer">Cidade</th>
          <th (click)="ordenarPor('jaEmpreende')" class="cursor-pointer">Empreende?</th>
          <th (click)="ordenarPor('clienteCrenorte')" class="cursor-pointer">Crenorte?</th>
          <th (click)="ordenarPor('valorSolicitado')" class="cursor-pointer">Valor</th>
          <th (click)="ordenarPor('dataPreenchimento')" class="cursor-pointer">Preenchido em</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of clientesPaginados">
          <td>{{ c.nomeCompleto }}</td>
          <td>{{ c.cpf }}</td>
          <td>{{ c.cidade }}</td>
          <td>{{ c.jaEmpreende ? 'Sim' : 'N√£o' }}</td>
          <td>{{ c.clienteCrenorte ? 'Sim' : 'N√£o' }}</td>
          <td>R$ {{ c.valorSolicitado | number:'1.0-0' }}</td>
          <td>{{ c.dataPreenchimento }}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary" (click)="editarCliente(c.cpf)">
              <i class="fas fa-edit me-1"></i> Editar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- PAGINA√á√ÉO -->
  <nav class="mt-4">
    <ul class="pagination justify-content-center">
      <li class="page-item" [class.disabled]="paginaAtual === 1">
        <button class="page-link" (click)="irParaPagina(paginaAtual - 1)">Anterior</button>
      </li>
      <li class="page-item" *ngFor="let p of [].constructor(totalPaginas); let i = index"
          [class.active]="paginaAtual === i + 1">
        <button class="page-link" (click)="irParaPagina(i + 1)">{{ i + 1 }}</button>
      </li>
      <li class="page-item" [class.disabled]="paginaAtual === totalPaginas">
        <button class="page-link" (click)="irParaPagina(paginaAtual + 1)">Pr√≥xima</button>
      </li>
    </ul>
  </nav>

  <!-- WHATSAPP -->
  <div *ngIf="linksWhatsapp?.length" class="mt-5">
    <h5 class="fw-bold text-success">üì≤ Mensagens WhatsApp Geradas:</h5>
    <ul class="list-group shadow-sm">
      <li *ngFor="let l of linksWhatsapp" class="list-group-item d-flex justify-content-between align-items-center">
        <span>
          <i class="fas fa-user me-2 text-secondary"></i>{{ l.nome }} - {{ l.numero }}
        </span>
        <a [href]="l.url" target="_blank" class="btn btn-sm btn-outline-success">
          Abrir no WhatsApp
        </a>
      </li>
    </ul>
  </div>
</div>
