import{a as I}from"./chunk-J65JDUIZ.js";import{b as B}from"./chunk-5Q5U7TJG.js";import{a as U,b as $,c as H}from"./chunk-S7BSO77O.js";import{c as N,e as m,f as T,g as D,j as A,m as V,n as z,o as R,p as q,q as L,s as j,u as G}from"./chunk-WYCOUGZ3.js";import"./chunk-FDAITWFV.js";import"./chunk-UQF2N3UO.js";import"./chunk-5OO6GXAC.js";import{l as F,w as k}from"./chunk-DTXGXR4A.js";import{Ia as P,Ka as d,Kb as O,Ua as S,Za as c,aa as w,fb as s,g as _,gb as y,ia as v,ib as o,ja as h,jb as t,kb as g,nb as E,qb as C,rb as b,wb as M,xa as u,xb as r,yb as x}from"./chunk-2KT3GOAN.js";function J(a,i){a&1&&(o(0,"span"),r(1,"Pronto"),t())}function K(a,i){a&1&&(o(0,"span"),r(1,"Salvando..."),t())}function W(a,i){if(a&1&&g(0,"img",44),a&2){let n=b();s("src",n.fotoPreview(),P)}}function X(a,i){a&1&&(o(0,"div",45),r(1,"Foto"),t())}function Z(a,i){a&1&&(o(0,"div",46),r(1," Informe o nome completo. "),t())}function ee(a,i){a&1&&(o(0,"div",46),r(1," E-mail inv\xE1lido. "),t())}function te(a,i){a&1&&(o(0,"div",46),r(1," M\xEDnimo de 6 caracteres. "),t())}function oe(a,i){if(a&1&&(o(0,"div",46),r(1),t()),a&2){let n=b();d(),x(n.cpfErro())}}function ne(a,i){if(a&1&&(o(0,"div",47),r(1),t()),a&2){let n=b();d(),x(n.erro())}}function re(a,i){if(a&1&&(o(0,"div",48),r(1),t()),a&2){let n=b();d(),x(n.ok())}}var Y=class a{fb=w(j);auth=w(I);storage=B;loading=u(!1);erro=u(null);ok=u(null);fotoFile=null;fotoPreview=u(null);form=this.fb.group({nome:["",m.required],email:["",[m.required,m.email]],senha:["",[m.required,m.minLength(6)]],cpf:["",[m.required,m.pattern(/^\d{11}$/)]],papel:["assessor",m.required],cargo:[""],status:["ativo",m.required]});onFotoChange(i){let e=i.target.files?.[0]||null;if(this.fotoFile=e??null,e){let l=new FileReader;l.onload=()=>this.fotoPreview.set(String(l.result)),l.readAsDataURL(e)}else this.fotoPreview.set(null)}cpfErro(){let i=this.form.get("cpf");if(!i||!i.touched)return null;let n=String(i.value||"").replace(/\D/g,"");return n?/^\d{11}$/.test(n)?this.validarCPF(n)?null:"CPF inv\xE1lido.":"Informe 11 d\xEDgitos.":"CPF \xE9 obrigat\xF3rio."}validarCPF(i){if(!i||i.length!==11||/^(\d)\1{10}$/.test(i))return!1;let n=0,e;for(let l=1;l<=9;l++)n+=parseInt(i.substring(l-1,l),10)*(11-l);if(e=n*10%11,(e===10||e===11)&&(e=0),e!==parseInt(i.substring(9,10),10))return!1;n=0;for(let l=1;l<=10;l++)n+=parseInt(i.substring(l-1,l),10)*(12-l);return e=n*10%11,(e===10||e===11)&&(e=0),e===parseInt(i.substring(10,11),10)}uploadFotoSeHouver(){return _(this,null,function*(){if(!this.fotoFile)return null;let i=(this.fotoFile.name||"avatar").replace(/[^\w.\-]/g,"_"),n=`colaboradores/avatars/${Date.now()}-${i}`,e=H(this.storage,n);return yield U(e,this.fotoFile,{contentType:this.fotoFile.type||"image/jpeg"}),yield $(e)})}criar(){return _(this,null,function*(){if(this.form.invalid){this.form.markAllAsTouched();return}let i=String(this.form.value.cpf||"").replace(/\D/g,"");if(!this.validarCPF(i)){this.form.get("cpf")?.markAsTouched(),this.erro.set("CPF inv\xE1lido.");return}this.loading.set(!0),this.erro.set(null),this.ok.set(null);let n=this.form.value;try{let e=yield this.uploadFotoSeHouver();yield this.auth.criarColaborador(n.email,n.senha,{nome:n.nome,email:n.email,cpf:i,papel:n.papel,cargo:n.cargo,status:n.status,photoURL:e||null}),this.ok.set("Colaborador criado com sucesso!"),this.form.get("senha")?.reset()}catch(e){this.erro.set(e?.message??"Falha ao criar colaborador")}finally{this.loading.set(!1)}})}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=S({type:a,selectors:[["app-colaboradores"]],decls:81,vars:15,consts:[["noFoto",""],[1,"container","py-4"],[1,"hdr","d-flex","align-items-end","justify-content-between","mb-4"],[1,"title","mb-1"],[1,"subtitle","mb-0"],[1,"badge-pill"],[4,"ngIf"],[1,"card","shadow-soft"],[1,"card-body",3,"ngSubmit","formGroup"],[1,"row","mb-4","align-items-center"],[1,"col-auto"],[1,"avatar-wrap"],["alt","Foto do colaborador","class","avatar-img",3,"src",4,"ngIf","ngIfElse"],[1,"col"],[1,"form-label","mb-1"],["type","file","accept","image/*",1,"form-control","form-control-sm","w-auto",3,"change"],[1,"text-muted","d-block","mt-1"],[1,"row","g-3"],[1,"col-md-6"],[1,"form-label"],["formControlName","nome","placeholder","Ex.: Maria Souza",1,"form-control"],["class","invalid-msg",4,"ngIf"],["formControlName","email","type","email","placeholder","email@empresa.com",1,"form-control"],["formControlName","senha","type","password","autocomplete","new-password","placeholder","M\xEDn. 6 caracteres",1,"form-control"],["formControlName","cpf","placeholder","Somente n\xFAmeros (11 d\xEDgitos)",1,"form-control"],[1,"col-md-4"],["formControlName","papel",1,"form-select"],["value","admin"],["value","supervisor"],["value","coordenador"],["value","assessor"],["value","operacional"],["value","rh"],["value","financeiro"],["value","qualidade"],["formControlName","status",1,"form-select"],["value","ativo"],["value","inativo"],[1,"mt-4","d-flex","gap-2"],[1,"btn","btn-primary","px-4",3,"disabled"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"mt-3"],["class","alert alert-danger py-2 px-3 mb-2",4,"ngIf"],["class","alert alert-success py-2 px-3",4,"ngIf"],["alt","Foto do colaborador",1,"avatar-img",3,"src"],[1,"avatar-skeleton"],[1,"invalid-msg"],[1,"alert","alert-danger","py-2","px-3","mb-2"],[1,"alert","alert-success","py-2","px-3"]],template:function(n,e){if(n&1){let l=E();o(0,"div",1)(1,"div",2)(2,"div")(3,"h3",3),r(4,"Gerenciar Colaboradores"),t(),o(5,"p",4),r(6,"Crie usu\xE1rios com CPF e foto de perfil para acesso ao sistema."),t()(),o(7,"div",5),c(8,J,2,0,"span",6)(9,K,2,0,"span",6),t()(),o(10,"div",7)(11,"form",8),C("ngSubmit",function(){return v(l),h(e.criar())}),o(12,"div",9)(13,"div",10)(14,"div",11),c(15,W,1,1,"img",12)(16,X,2,0,"ng-template",null,0,O),t()(),o(18,"div",13)(19,"label",14),r(20,"Foto de perfil (opcional)"),t(),o(21,"input",15),C("change",function(f){return v(l),h(e.onFotoChange(f))}),t(),o(22,"small",16),r(23,"Imagem exibida no perfil ap\xF3s o login do colaborador."),t()()(),o(24,"div",17)(25,"div",18)(26,"label",19),r(27,"Nome"),t(),g(28,"input",20),c(29,Z,2,0,"div",21),t(),o(30,"div",18)(31,"label",19),r(32,"E-mail"),t(),g(33,"input",22),c(34,ee,2,0,"div",21),t(),o(35,"div",18)(36,"label",19),r(37,"Senha (inicial)"),t(),g(38,"input",23),c(39,te,2,0,"div",21),t(),o(40,"div",18)(41,"label",19),r(42,"CPF"),t(),g(43,"input",24),c(44,oe,2,1,"div",21),t(),o(45,"div",25)(46,"label",19),r(47,"Papel"),t(),o(48,"select",26)(49,"option",27),r(50,"Administrador"),t(),o(51,"option",28),r(52,"Supervisor"),t(),o(53,"option",29),r(54,"Coordenador"),t(),o(55,"option",30),r(56,"Assessor"),t(),o(57,"option",31),r(58,"Operacional"),t(),o(59,"option",32),r(60,"RH"),t(),o(61,"option",33),r(62,"Financeiro"),t(),o(63,"option",34),r(64,"Controle de Qualidade"),t()()(),o(65,"div",25)(66,"label",19),r(67,"Status"),t(),o(68,"select",35)(69,"option",36),r(70,"Ativo"),t(),o(71,"option",37),r(72,"Inativo"),t()()()(),o(73,"div",38)(74,"button",39),r(75,"Criar colaborador"),t(),o(76,"button",40),C("click",function(){return v(l),h(e.form.reset({papel:"assessor",status:"ativo"}))}),r(77," Limpar "),t()(),o(78,"div",41),c(79,ne,2,1,"div",42)(80,re,2,1,"div",43),t()()()()}if(n&2){let l,p,f,Q=M(17);d(7),y("badge-loading",e.loading()),d(),s("ngIf",!e.loading()),d(),s("ngIf",e.loading()),d(2),s("formGroup",e.form),d(4),s("ngIf",e.fotoPreview())("ngIfElse",Q),d(14),s("ngIf",((l=e.form.get("nome"))==null?null:l.touched)&&((l=e.form.get("nome"))==null?null:l.invalid)),d(5),s("ngIf",((p=e.form.get("email"))==null?null:p.touched)&&((p=e.form.get("email"))==null?null:p.invalid)),d(5),s("ngIf",((f=e.form.get("senha"))==null?null:f.touched)&&((f=e.form.get("senha"))==null?null:f.invalid)),d(5),s("ngIf",e.cpfErro()),d(30),s("disabled",e.form.invalid||e.loading()),d(2),s("disabled",e.loading()),d(3),s("ngIf",e.erro()),d(),s("ngIf",e.ok())}},dependencies:[k,F,G,A,q,L,N,R,T,D,V,z],styles:["[_ngcontent-%COMP%]:root{--surface: #ffffff;--muted: #6b7280;--primary: #16a34a;--primary-600: #15803d;--ring: #10b9811a;--shadow: 0 10px 25px rgba(0,0,0,.06), 0 2px 8px rgba(0,0,0,.04);--radius: 16px}.container[_ngcontent-%COMP%]{max-width:1000px}.title[_ngcontent-%COMP%]{font-weight:700;letter-spacing:.2px}.subtitle[_ngcontent-%COMP%]{color:var(--muted);font-size:.95rem}.badge-pill[_ngcontent-%COMP%]{padding:.35rem .9rem;border-radius:999px;background:#f3f4f6;color:#111827;font-weight:600;font-size:.85rem;transition:all .2s ease}.badge-loading[_ngcontent-%COMP%]{background:#eefdf3;color:var(--primary-600);box-shadow:0 0 0 6px var(--ring)}.card.shadow-soft[_ngcontent-%COMP%]{border:0;border-radius:var(--radius);box-shadow:var(--shadow)}.card-body[_ngcontent-%COMP%]{padding:1.75rem}.form-label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.35rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-radius:10px;border:1px solid #e5e7eb;transition:all .15s ease;padding:.6rem .8rem}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 0 0 .2rem #22c55e33}.invalid-msg[_ngcontent-%COMP%]{color:#b91c1c;font-size:.8rem;margin-top:.25rem}.avatar-wrap[_ngcontent-%COMP%]{width:96px;height:96px;border-radius:999px;border:6px solid #f3f4f6;background:linear-gradient(180deg,#fafafa,#f1f5f9);display:grid;place-items:center;position:relative;box-shadow:0 6px 20px #0000000f}.avatar-img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:999px;object-fit:cover}.avatar-skeleton[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:999px;display:grid;place-items:center;color:#9ca3af;font-weight:600;font-size:.9rem;background:repeating-linear-gradient(-45deg,#f3f4f6,#f3f4f6 10px,#e5e7eb 10px 20px)}.btn[_ngcontent-%COMP%]{border-radius:10px;padding:.6rem 1rem;font-weight:600;transition:transform .04s ease,box-shadow .15s ease}.btn[_ngcontent-%COMP%]:active{transform:translateY(1px)}.btn-success[_ngcontent-%COMP%]{background:var(--primary);border-color:var(--primary);box-shadow:0 6px 16px #16a34a33}.btn-success[_ngcontent-%COMP%]:hover{background:var(--primary-600);border-color:var(--primary-600)}.btn-outline-secondary[_ngcontent-%COMP%]{border:1px solid #e5e7eb;color:#111827;background:#fff}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background:#f9fafb}.alert[_ngcontent-%COMP%]{border-radius:12px;border:0}.alert-danger[_ngcontent-%COMP%]{background:#fef2f2;color:#991b1b}.alert-success[_ngcontent-%COMP%]{background:#ecfdf5;color:#065f46}.hdr[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .hdr[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{line-height:1.2}@media (max-width: 576px){.card-body[_ngcontent-%COMP%]{padding:1.25rem}.avatar-wrap[_ngcontent-%COMP%]{width:80px;height:80px}}.title[_ngcontent-%COMP%]{font-weight:800}.subtitle[_ngcontent-%COMP%]{color:#6c757d}.badge-pill[_ngcontent-%COMP%]{padding:.35rem .75rem;border-radius:999px;font-weight:600;background:#e9f7ef;color:#198754;border:1px solid #cfead8}.badge-loading[_ngcontent-%COMP%]{background:#fff3cd;color:#856404;border-color:#ffe8a1}.nav-card[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;padding:1rem 1.25rem;border:1px solid #e9ecef;border-radius:1rem;background:#fff;cursor:pointer;transition:transform .15s ease,box-shadow .15s ease,border-color .15s ease}.nav-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #0000000f}.nav-card.active[_ngcontent-%COMP%]{border-color:#0d6efd;box-shadow:0 0 0 3px #0d6efd1a}.nav-card__icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:12px;display:grid;place-items:center;font-size:20px;font-weight:800;background:#f1f5ff;color:#0d6efd}.shadow-soft[_ngcontent-%COMP%]{box-shadow:0 10px 30px #0000000f;border:none}.avatar-wrap[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;border:2px dashed #dee2e6;display:grid;place-items:center;overflow:hidden;background:#f8f9fa}.avatar-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.avatar-skeleton[_ngcontent-%COMP%]{font-size:12px;color:#6c757d;-webkit-user-select:none;user-select:none}.avatar-mini[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background-size:cover;background-position:center;display:grid;place-items:center;font-weight:700;color:#495057;background-color:#e9ecef}.invalid-msg[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem;margin-top:.25rem}"]})};export{Y as ColaboradoresComponent};
