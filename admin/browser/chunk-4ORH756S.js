import{c as q,f as X,g as D,h as Q,i as j,j as Y,l as G,r as H,t as U}from"./chunk-WYCOUGZ3.js";import{a as J}from"./chunk-F34SCIM2.js";import"./chunk-FDAITWFV.js";import{f as A,g as B,k as z}from"./chunk-FTITK7GV.js";import"./chunk-UQF2N3UO.js";import"./chunk-5OO6GXAC.js";import{k as I,l as L,w as R}from"./chunk-DTXGXR4A.js";import{Bb as g,Cb as u,Db as f,Ka as c,Ua as x,Za as h,aa as v,fb as b,g as y,gb as P,ia as s,ib as t,ja as m,jb as n,kb as F,nb as M,qb as C,rb as _,tb as O,ub as V,vb as W,wb as T,xa as k,xb as a,yb as N}from"./chunk-2KT3GOAN.js";var $=["feedbackModal"];function ee(p,l){if(p&1&&(t(0,"div",55),a(1),n()),p&2){let r=_();c(),N(r.msg())}}function te(p,l){if(p&1){let r=M();t(0,"button",56),C("click",function(){let i=s(r).$implicit,d=_();return m(d.setStar("notaAtendimento",i))}),a(1,"\u2605"),n()}if(p&2){let r=l.$implicit,e=_();P("active",e.feedback.notaAtendimento>=r)}}function ne(p,l){if(p&1){let r=M();t(0,"button",56),C("click",function(){let i=s(r).$implicit,d=_();return m(d.setStar("cordialidade",i))}),a(1,"\u2605"),n()}if(p&2){let r=l.$implicit,e=_();P("active",e.feedback.cordialidade>=r)}}function oe(p,l){if(p&1){let r=M();t(0,"button",56),C("click",function(){let i=s(r).$implicit,d=_();return m(d.setStar("clareza",i))}),a(1,"\u2605"),n()}if(p&2){let r=l.$implicit,e=_();P("active",e.feedback.clareza>=r)}}var K=class p{service=v(J);router=v(A);feedbackModalRef;feedbackModal;loading=k(!1);msg=k(null);model={nomeCompleto:"",cpf:"",endereco:"",telefone:"",email:""};lastPreCadastroId=null;feedback={notaAtendimento:5,cordialidade:5,clareza:5,recebeuInformacoesCompletas:!0,recomendaria:!0,comentarios:""};stars=[1,2,3,4,5];limpar(l){return(l||"").trim()}cpfValido(l){let r=(l||"").replace(/\D/g,"");if(r.length!==11||/^(\d)\1{10}$/.test(r))return!1;let e=(o,Z)=>{let S=0;for(let w=0;w<o.length;w++)S+=parseInt(o[w],10)*(Z-w);let E=S%11;return E<2?0:11-E};return!(e(r.substring(0,9),10)!==parseInt(r[9],10)||e(r.substring(0,10),11)!==parseInt(r[10],10))}salvar(l){return y(this,null,function*(){if(this.loading())return;let r={nomeCompleto:this.limpar(this.model.nomeCompleto),cpf:this.limpar(this.model.cpf),endereco:this.limpar(this.model.endereco),telefone:this.limpar(this.model.telefone),email:this.limpar(this.model.email)};if(!l.valid||!this.cpfValido(r.cpf)){this.msg.set("Preencha os campos corretamente (CPF inv\xE1lido).");return}this.loading.set(!0),this.msg.set(null);try{let e=yield this.service.criar(r);this.lastPreCadastroId=e,this.msg.set("Pr\xE9-cadastro salvo com sucesso!"),l.resetForm(),setTimeout(()=>this.abrirFeedbackModal(),0)}catch(e){console.error("[PreCadastro] Erro ao salvar pr\xE9-cadastro:",e),this.msg.set(e?.message||"Erro ao salvar o pr\xE9-cadastro.")}finally{this.loading.set(!1)}})}abrirFeedbackModal(){this.feedbackModalRef&&(this.feedbackModal=new bootstrap.Modal(this.feedbackModalRef.nativeElement,{backdrop:"static"}),this.feedbackModal.show())}fecharFeedbackModal(){this.feedbackModal?.hide()}setStar(l,r){this.feedback[l]=r}salvarFeedbackCliente(){return y(this,null,function*(){if(!this.lastPreCadastroId){this.msg.set("N\xE3o foi poss\xEDvel identificar o pr\xE9-cadastro para registrar o feedback.");return}try{yield this.service.registrarFeedbackCliente(this.lastPreCadastroId,this.feedback),this.msg.set("Avalia\xE7\xE3o do cliente registrada. Obrigado!"),this.fecharFeedbackModal()}catch(l){console.error("[PreCadastro] Erro ao salvar feedback do cliente:",l),this.msg.set(l?.message||"Erro ao salvar a avalia\xE7\xE3o do cliente.")}})}static \u0275fac=function(r){return new(r||p)};static \u0275cmp=x({type:p,selectors:[["app-pre-cadastro-form"]],viewQuery:function(r,e){if(r&1&&O($,5),r&2){let i;V(i=W())&&(e.feedbackModalRef=i.first)}},decls:99,vars:19,consts:[["f","ngForm"],["feedbackModal",""],[1,"container-fluid","py-4"],[1,"container","py-4","card-crenorte","shadow-lg","rounded","precadastro",3,"ngSubmit"],[1,"form-header","d-flex","justify-content-between","align-items-center","mb-3"],[1,"title-box","px-2"],[1,"form-title","mb-0"],[1,"subtitle"],[1,"logo-box"],["src","../../../assets/img/logo2-crenorte.png","alt","Logo CRENORTE",1,"logo-img"],[1,"card","shadow-soft"],[1,"card-body"],[1,"row","g-3","g-md-4"],[1,"col-12","col-md-6"],[1,"form-label"],["name","nomeCompleto","required","","autocomplete","name",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12","col-md-3"],["name","cpf","required","","placeholder","000.000.000-00","inputmode","numeric",1,"form-control",3,"ngModelChange","ngModel"],["name","telefone","required","","placeholder","(91) 9XXXX-XXXX","inputmode","tel","autocomplete","tel",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12","col-md-8"],["name","endereco","required","","autocomplete","street-address",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12","col-md-4"],["type","email","name","email","required","","autocomplete","email",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2","mt-4","sticky-actions-md"],[1,"btn","btn-crn-success",3,"disabled"],["routerLink","/pre-cadastro/minha-lista",1,"btn","btn-outline-secondary"],["class","alert alert-info mt-3",4,"ngIf"],["tabindex","-1","aria-labelledby","feedbackLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","feedbackLabel",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"text-muted","mb-3"],[1,"row","g-3"],[1,"col-md-4"],[1,"stars"],["type","button",3,"active","click",4,"ngFor","ngForOf"],[1,"col-md-6"],[1,"form-label","d-block"],[1,"btn-group","w-100"],["type","radio","id","infSim","name","infComp",1,"btn-check",3,"ngModelChange","ngModel","value"],["for","infSim",1,"btn","btn-outline-success"],["type","radio","id","infNao","name","infComp",1,"btn-check",3,"ngModelChange","ngModel","value"],["for","infNao",1,"btn","btn-outline-danger"],["type","radio","id","recSim","name","recomendaria",1,"btn-check",3,"ngModelChange","ngModel","value"],["for","recSim",1,"btn","btn-outline-success"],["type","radio","id","recNao","name","recomendaria",1,"btn-check",3,"ngModelChange","ngModel","value"],["for","recNao",1,"btn","btn-outline-danger"],[1,"col-12"],["rows","3","name","comentariosCliente","placeholder","Conte como foi o atendimento, o que pode melhorar...",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"alert","alert-info","mt-3"],["type","button",3,"click"]],template:function(r,e){if(r&1){let i=M();t(0,"div",2)(1,"form",3,0),C("ngSubmit",function(){s(i);let o=T(2);return m(e.salvar(o))}),t(3,"div",4)(4,"div",5)(5,"h2",6),a(6,"Novo Pr\xE9-cadastro"),n(),t(7,"small",7),a(8,"Microcr\xE9dito Produtivo Orientado"),n()(),t(9,"div",8),F(10,"img",9),n()(),t(11,"div",10)(12,"div",11)(13,"div",12)(14,"div",13)(15,"label",14),a(16,"Nome Completo"),n(),t(17,"input",15),f("ngModelChange",function(o){return s(i),u(e.model.nomeCompleto,o)||(e.model.nomeCompleto=o),m(o)}),n()(),t(18,"div",16)(19,"label",14),a(20,"CPF"),n(),t(21,"input",17),f("ngModelChange",function(o){return s(i),u(e.model.cpf,o)||(e.model.cpf=o),m(o)}),n()(),t(22,"div",16)(23,"label",14),a(24,"Telefone (WhatsApp)"),n(),t(25,"input",18),f("ngModelChange",function(o){return s(i),u(e.model.telefone,o)||(e.model.telefone=o),m(o)}),n()(),t(26,"div",19)(27,"label",14),a(28,"Endere\xE7o"),n(),t(29,"input",20),f("ngModelChange",function(o){return s(i),u(e.model.endereco,o)||(e.model.endereco=o),m(o)}),n()(),t(30,"div",21)(31,"label",14),a(32,"E-mail"),n(),t(33,"input",22),f("ngModelChange",function(o){return s(i),u(e.model.email,o)||(e.model.email=o),m(o)}),n()()(),t(34,"div",23)(35,"button",24),a(36,"Salvar"),n(),t(37,"a",25),a(38,"Minha Lista"),n()(),h(39,ee,2,1,"div",26),n()()()(),t(40,"div",27,1)(42,"div",28)(43,"div",29)(44,"div",30)(45,"h5",31),a(46,"Avalia\xE7\xE3o do Atendimento"),n(),t(47,"button",32),C("click",function(){return s(i),m(e.fecharFeedbackModal())}),n()(),t(48,"div",33)(49,"p",34),a(50," Esta etapa \xE9 para o "),t(51,"strong"),a(52,"cliente"),n(),a(53," avaliar o atendimento do assessor. Por favor, entregue este aparelho ao cliente para responder. "),n(),t(54,"div",35)(55,"div",36)(56,"label",14),a(57,"Atendimento geral"),n(),t(58,"div",37),h(59,te,2,2,"button",38),n()(),t(60,"div",36)(61,"label",14),a(62,"Cordialidade"),n(),t(63,"div",37),h(64,ne,2,2,"button",38),n()(),t(65,"div",36)(66,"label",14),a(67,"Clareza das informa\xE7\xF5es"),n(),t(68,"div",37),h(69,oe,2,2,"button",38),n()(),t(70,"div",39)(71,"label",40),a(72,"Recebeu todas as informa\xE7\xF5es direitinho?"),n(),t(73,"div",41)(74,"input",42),f("ngModelChange",function(o){return s(i),u(e.feedback.recebeuInformacoesCompletas,o)||(e.feedback.recebeuInformacoesCompletas=o),m(o)}),n(),t(75,"label",43),a(76,"Sim"),n(),t(77,"input",44),f("ngModelChange",function(o){return s(i),u(e.feedback.recebeuInformacoesCompletas,o)||(e.feedback.recebeuInformacoesCompletas=o),m(o)}),n(),t(78,"label",45),a(79,"N\xE3o"),n()()(),t(80,"div",39)(81,"label",40),a(82,"Recomendaria este atendimento?"),n(),t(83,"div",41)(84,"input",46),f("ngModelChange",function(o){return s(i),u(e.feedback.recomendaria,o)||(e.feedback.recomendaria=o),m(o)}),n(),t(85,"label",47),a(86,"Sim"),n(),t(87,"input",48),f("ngModelChange",function(o){return s(i),u(e.feedback.recomendaria,o)||(e.feedback.recomendaria=o),m(o)}),n(),t(88,"label",49),a(89,"N\xE3o"),n()()(),t(90,"div",50)(91,"label",14),a(92,"Coment\xE1rio (opcional)"),n(),t(93,"textarea",51),f("ngModelChange",function(o){return s(i),u(e.feedback.comentarios,o)||(e.feedback.comentarios=o),m(o)}),n()()()(),t(94,"div",52)(95,"button",53),C("click",function(){return s(i),m(e.fecharFeedbackModal())}),a(96,"Pular"),n(),t(97,"button",54),C("click",function(){return s(i),m(e.salvarFeedbackCliente())}),a(98,"Enviar avalia\xE7\xE3o"),n()()()()()}r&2&&(c(17),g("ngModel",e.model.nomeCompleto),c(4),g("ngModel",e.model.cpf),c(4),g("ngModel",e.model.telefone),c(4),g("ngModel",e.model.endereco),c(4),g("ngModel",e.model.email),c(2),b("disabled",e.loading()),c(4),b("ngIf",e.msg()),c(20),b("ngForOf",e.stars),c(5),b("ngForOf",e.stars),c(5),b("ngForOf",e.stars),c(5),g("ngModel",e.feedback.recebeuInformacoesCompletas),b("value",!0),c(3),g("ngModel",e.feedback.recebeuInformacoesCompletas),b("value",!1),c(7),g("ngModel",e.feedback.recomendaria),b("value",!0),c(3),g("ngModel",e.feedback.recomendaria),b("value",!1),c(6),g("ngModel",e.feedback.comentarios))},dependencies:[R,I,L,U,Y,q,G,X,D,H,j,Q,z,B],styles:[".form-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}.form-title[_ngcontent-%COMP%]{margin:0;font-size:1.8rem;font-weight:800;color:#006e37}.subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#555}.logo-box[_ngcontent-%COMP%]{flex-shrink:0}.logo-img[_ngcontent-%COMP%]{height:70px;width:auto;display:block}@media (max-width: 576px){.logo-img[_ngcontent-%COMP%]{height:50px}.form-title[_ngcontent-%COMP%]{font-size:1.25rem}.subtitle[_ngcontent-%COMP%]{font-size:.9rem}}.precadastro[_ngcontent-%COMP%]{--crn-green: #20a060;--crn-green-2: #1a8a53;--radius: 14px;--shadow: 0 6px 18px rgba(0,0,0,.06);--shadow-hover: 0 10px 26px rgba(0,0,0,.09)}.card-crenorte[_ngcontent-%COMP%], .precadastro[_ngcontent-%COMP%]   .card.shadow-soft[_ngcontent-%COMP%]{border:0;border-radius:var(--radius);box-shadow:var(--shadow);background:#fff}.precadastro[_ngcontent-%COMP%]   .card.shadow-soft[_ngcontent-%COMP%]:hover{box-shadow:var(--shadow-hover)}.precadastro[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .precadastro[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{height:48px;border-radius:12px;border-color:#e6e6e6;background:#fff;transition:all .18s ease}.precadastro[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .precadastro[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus{border-color:var(--crn-green);box-shadow:0 0 0 .2rem #20a0601f}.precadastro[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:600;color:#3f3f3f}.precadastro[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:#b8b8b8}.btn-crn-success[_ngcontent-%COMP%]{background:var(--crn-green);color:#fff;border:none;border-radius:12px;padding:.75rem 1.2rem;font-weight:600;box-shadow:var(--shadow);transition:transform .12s ease,box-shadow .12s ease,background .12s ease}.btn-crn-success[_ngcontent-%COMP%]:hover{background:var(--crn-green-2);transform:translateY(-1px)}.btn-crn-success[_ngcontent-%COMP%]:disabled{opacity:.85;transform:none}@media (min-width: 768px) and (max-width: 1199.98px){.sticky-actions-md[_ngcontent-%COMP%]{position:sticky;bottom:.5rem;padding-top:.5rem;background:linear-gradient(to bottom,#fff0,#fff 55%)}.precadastro[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.5rem 1.75rem}.precadastro[_ngcontent-%COMP%]   .row.g-md-4[_ngcontent-%COMP%]{--bs-gutter-x: 1.25rem;--bs-gutter-y: 1.25rem}}.stars[_ngcontent-%COMP%]{display:flex;gap:.25rem;-webkit-user-select:none;user-select:none}.stars[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;background:transparent;font-size:28px;line-height:1;color:#c8c8c8;cursor:pointer;padding:0 2px;transition:transform .08s ease,color .15s ease}.stars[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{color:#f7b500}.stars[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-1px) scale(1.05)}.modal[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:10px}"]})};export{K as PreCadastroFormComponent};
